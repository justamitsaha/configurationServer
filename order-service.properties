################################################
## ? SPRING BOOT APPLICATION CONFIGURATION
################################################
## Application name (used in logs, service discovery, etc.)
#spring.application.name=order-service


###############################################
# ?? DATABASE (R2DBC + MySQL)
# Reactive MySQL connection URL (note: R2DBC uses a reactive driver, not JDBC)
###############################################
spring.r2dbc.url=${SPRING_R2DBC_URL:r2dbc:mysql://localhost:3306/amit?serverTimezone=Asia/Kolkata}
spring.r2dbc.username=${SPRING_R2DBC_USERNAME:root}
spring.r2dbc.password=${SPRING_R2DBC_PASSWORD:shamit2020}


###############################################
# ? KAFKA CONFIGURATION
###############################################
# Kafka cluster bootstrap servers (comma-separated list of brokers)
spring.kafka.bootstrap-servers=${SPRING_KAFKA_BOOTSTRAP:localhost:9092,localhost:9093,localhost:9094}

# Kafka topics for different purposes
app.kafka.topic.order=${APP_KAFKA_TOPIC_ORDER:order.events}
app.kafka.topic.order.dlt=${APP_KAFKA_TOPIC_ORDER_DLT:order.events.dlt}
app.kafka.topic.order.retry=${APP_KAFKA_TOPIC_ORDER_RETRY:order.events.retry}
app.kafka.topic.order.proto=${APP_KAFKA_TOPIC_ORDER_PROTO:order.events.proto}

# Kafka retry configs
app.kafka.retry.max-attempts=${APP_KAFKA_RETRY_MAX_ATTEMPTS:3}

# Outbox configs
app.kafka.outbox.poll-interval=${APP_KAFKA_OUTBOX_POLL_INTERVAL:PT1S}
app.kafka.outbox.batch-size=${APP_KAFKA_OUTBOX_BATCH_SIZE:50}
app.kafka.outbox.max-attempts=${APP_KAFKA_OUTBOX_MAX_ATTEMPTS:5}

# Schema Registry
app.kafka.schema-registry-url=${SCHEMA_REGISTRY_URL:http://localhost:8081}


###############################################
# ? SWAGGER / OPENAPI
###############################################
springdoc.swagger-ui.path=${SWAGGER_UI_PATH:/swagger-ui/index.html}


###############################################
# ? ACTUATOR & OBSERVABILITY
###############################################
management.endpoints.web.exposure.include=${MANAGEMENT_ENDPOINTS:health,info,metrics,prometheus,refresh,busrefresh}

# OpenTelemetry tracing configuration
management.tracing.sampling.probability=${TRACING_SAMPLING:1.0}

# OTLP trace collector endpoint
management.tracing.export.otlp.endpoint=${OTLP_ENDPOINT:http://localhost:4318/v1/traces}

# HTTP Request SLO Metrics
management.metrics.distribution.percentiles.http.server.requests=${HTTP_SERVER_REQ_PERCENTILES:0.5,0.9,0.95,0.99}
management.metrics.distribution.slo.http.server.requests=${HTTP_SERVER_REQ_SLO:100ms,250ms,500ms,1s,2s}


###############################################
# ? EUREKA CLIENT
###############################################
eureka.client.service-url.defaultZone=${EUREKA_DEFAULT_ZONE:http://localhost:8761/eureka}
eureka.instance.prefer-ip-address=${EUREKA_PREFER_IP:true}


###############################################
# ? LOGGING CONFIGURATION
###############################################
logging.pattern.console=${LOGPATTERN_CONSOLE:%green(%d{HH:mm:ss.SSS}) %blue(%-5level) %red([%thread]) %yellow(%class.%M:%L) - %msg%n}
logging.level.root=${LOG_LEVEL_ROOT:INFO}
logging.level.org.springframework.boot=${LOG_LEVEL_SPRING_BOOT:INFO}
logging.level.org.springframework.cloud=${LOG_LEVEL_SPRING_CLOUD:WARN}
logging.level.org.apache.kafka=${LOG_LEVEL_KAFKA:WARN}
logging.level.org.springframework.integration=${LOG_LEVEL_SI:WARN}
logging.level.io.opentelemetry=${LOG_LEVEL_OTEL:ERROR}

# order discount values
order.discount=${ORDER_DISCOUNT:{cipher}3aa9b553da5dce68471097ab11b5f1c03211eb448c022300084798c47eed6160}
order.use-protobuf=${ORDER_USE_PROTOBUF:false}

logging.pattern.console=${LOGGING_PATTERN_CONSOLE:%d{yyyy-MM-dd HH:mm:ss.SSS} %-5level [%thread] %logger{36} - %msg%n}
